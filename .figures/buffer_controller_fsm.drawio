<mxfile host="app.diagrams.net" modified="2022-04-19T06:34:36.815Z" agent="5.0 (X11)" etag="Z0-U6Xwsmy7_3imyrRyc" version="16.5.6" type="github">
  <diagram id="vcOmwt670LHLFmOHfxU6" name="Page-1">
    <mxGraphModel dx="2272" dy="1893" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="8YBCCptctLdzBx9tajcS-1" value="s_rst" style="ellipse;shape=doubleEllipse;whiteSpace=wrap;html=1;aspect=fixed;" parent="1" vertex="1">
          <mxGeometry x="345" y="50" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="8YBCCptctLdzBx9tajcS-2" value="&lt;div&gt;&lt;b&gt;Ports&lt;/b&gt;:&lt;/div&gt;&lt;div&gt;&lt;ul&gt;&lt;li&gt;t_sample_en : out std_logic (assigned output)&lt;br&gt;&lt;/li&gt;&lt;li&gt;t_sample_rest : out std_logic (assigned transition)&lt;br&gt;&lt;/li&gt;&lt;li&gt;t_sample_irq : in std_logic&lt;/li&gt;&lt;li&gt;t_sample_cnt : in std_logic_vector&lt;/li&gt;&lt;li&gt;t_sample_target: in std_logic_vector&lt;br&gt;&lt;/li&gt;&lt;li&gt;t_period_en : out std_logic (assigned output)&lt;br&gt;&lt;/li&gt;&lt;li&gt;t_period_rest : out std_logic (assigned transition)&lt;br&gt;&lt;/li&gt;&lt;li&gt;t_period_irq : in std_logic&lt;/li&gt;&lt;li&gt;t_period_cnt : in std_logic_vector&lt;/li&gt;&lt;li&gt;t_period_target: in std_logic_vector&lt;br&gt;&lt;/li&gt;&lt;li&gt;adc_din : in std_logic_vector&lt;/li&gt;&lt;li&gt;adc_ch : in std_logic_vector&lt;/li&gt;&lt;li&gt;adc_irq : in std_logic&lt;/li&gt;&lt;li&gt;bf_wr_addr : out std_logic_vector (assigned concurrently)&lt;br&gt;&lt;/li&gt;&lt;li&gt;bf_wr_data : out std_logic_vector (assigned concurrently)&lt;/li&gt;&lt;li&gt;bf_wr : out std_logic_vector (assigned concurrently)&lt;/li&gt;&lt;li&gt;bf_shift : out std_logic_vector (assigned concurrently)&lt;br&gt;&lt;/li&gt;&lt;li&gt;bf_irq : in std_logic_vector&lt;/li&gt;&lt;li&gt;lut_n_over: out std_logic_vector&lt;/li&gt;&lt;li&gt;lut_top_val : out std_logic_vector&lt;/li&gt;&lt;li&gt;lut_gain_UnD : out std_logic&lt;/li&gt;&lt;li&gt;lut_curr_gain : out std_logic_vector&lt;/li&gt;&lt;li&gt;lut_new_gain : in std_logic_vector&lt;/li&gt;&lt;li&gt;lut_irq: in std_logic&lt;br&gt;&lt;/li&gt;&lt;li&gt;gain_curr : in std_logic_vector&lt;/li&gt;&lt;li&gt;gain_ref : out std_logic_vector (assigned concurrently)&lt;br&gt;&lt;/li&gt;&lt;li&gt;n_samples_out : std_logic_vector (assigned transition)&lt;/li&gt;&lt;li&gt;irq_out : out std_logic_vector (assigned transition)&lt;/li&gt;&lt;/ul&gt;&lt;div&gt;&lt;b&gt;Signals:&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;ul&gt;&lt;li&gt;next_ch : unsigned &amp;lt;= 0&lt;/li&gt;&lt;li&gt;sampling : std_logic &amp;lt;= &#39;0&#39;&lt;/li&gt;&lt;li&gt;wr_addr_cnt : std_logic_vector&lt;/li&gt;&lt;li&gt;sample_start: std_logic&lt;/li&gt;&lt;li&gt;sample_stop: std_logic&lt;/li&gt;&lt;li&gt;period_done: std_logic&lt;br&gt;&lt;/li&gt;&lt;li&gt;shifted_hold: std_logic_vector&lt;/li&gt;&lt;li&gt;accept_mask: std_logic_vector&lt;/li&gt;&lt;li&gt;top_values: array of std_logic_vector&lt;/li&gt;&lt;li&gt;n_over array of unsigned&lt;/li&gt;&lt;li&gt;top_mags: array of std_logic_vector&lt;/li&gt;&lt;li&gt;n_over_mags: array of unsigned&lt;/li&gt;&lt;li&gt;gain_UnD: std_logic_vector&lt;/li&gt;&lt;li&gt;gain_mon_rdy : std_logicfi&lt;br&gt;&lt;/li&gt;&lt;li&gt;gain_curr_int: array of std_logic_vector&lt;br&gt;&lt;/li&gt;&lt;li&gt;gain_ref_int: array of std_logic_vector&lt;/li&gt;&lt;li&gt;gain_settled : std_logic&lt;/li&gt;&lt;li&gt;mag_cnt: unsigned&lt;/li&gt;&lt;li&gt;bf_shift_int: std_logic_vector&lt;br&gt;&lt;/li&gt;&lt;/ul&gt;&lt;div&gt;&lt;b&gt;Generic:&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;ul&gt;&lt;li&gt;GAIN_HYST_MAX_THRESH&lt;/li&gt;&lt;li&gt;GAIN_HYST_MIN_THRESH&lt;/li&gt;&lt;li&gt;t_sample_target&lt;/li&gt;&lt;li&gt;t_period_target&lt;br&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;Concurrent statements:&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;ul&gt;&lt;li&gt;t_sample_target &amp;lt;= to_unsigned(t_sample_target_val, t_sample_n_bits)&lt;/li&gt;&lt;li&gt;t_period_target &amp;lt;= to_unsigned(t_period_target_val, t_period_n_bits)&lt;br&gt;&lt;/li&gt;&lt;li&gt;bf_wr &amp;lt;= &lt;span&gt; &lt;/span&gt;adc_irq when sampling=&#39;1&#39; and adc_ch=next_ch else&lt;br&gt;&lt;span&gt; &lt;/span&gt;&lt;span&gt; &lt;/span&gt;&lt;span&gt; &lt;/span&gt;&lt;span&gt; &lt;/span&gt;&#39;0&#39;; (using generate statement)&lt;br&gt;&lt;/li&gt;&lt;li&gt;bf_wr_addr &amp;lt;= wr_addr_cnt;&lt;/li&gt;&lt;li&gt;bf_wr_data&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;=&amp;nbsp; t_sample_cnt &amp;amp; adc_din;&lt;/li&gt;&lt;li&gt;gain_curr_int(3) &amp;lt;= gain_curr(23 downto 18)&lt;/li&gt;&lt;li&gt;gain_curr_int(2) &amp;lt;= gain_curr(17 downto 12)&lt;/li&gt;&lt;li&gt;gain_curr_int(1) &amp;lt;= gain_curr(11 downto 6)&lt;/li&gt;&lt;li&gt;gain_curr_int(0) &amp;lt;= gain_curr(5 downto 0)&lt;br&gt;&lt;/li&gt;&lt;li&gt;gain_ref(23 downto 18) &amp;lt;= gain_ref_int(3)&lt;/li&gt;&lt;li&gt;gain_ref(19 downto 12) &amp;lt;= gain_ref_int(2)&lt;/li&gt;&lt;li&gt;gain_ref(11 downto 6) &amp;lt;= gain_ref_int(1)&lt;/li&gt;&lt;li&gt;gain_ref(5 downto 0) &amp;lt;= gain_ref_int(0)&lt;/li&gt;&lt;li&gt;gain_settled &amp;lt;= &#39;1&#39; when gain_curr = gain_ref else &#39;0&#39;&lt;/li&gt;&lt;li&gt;bf_shift &amp;lt;= bf_shift_int&lt;br&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;Auxiliary processes:&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;ul&gt;&lt;li&gt;Process to set sample_start upon sample timer irq and clear on rising edge of sampling&lt;br&gt;&lt;/li&gt;&lt;li&gt;Process to set sample_stop upon period timer irq and clear upon rising edge of bf_shift&lt;/li&gt;&lt;li&gt;Process asserting shifted hold upon bf_irq, and clear when last one clears&lt;/li&gt;&lt;li&gt;Process monitoring the input signals when sampling, evaluate gain change when period is done, and resets signals when period starts again&lt;br&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="1630" y="-210" width="410" height="1550" as="geometry" />
        </mxCell>
        <mxCell id="8YBCCptctLdzBx9tajcS-3" value="&lt;div&gt;s_sample&lt;/div&gt;&lt;div&gt;_first&lt;/div&gt;" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" parent="1" vertex="1">
          <mxGeometry x="150" y="230" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="8YBCCptctLdzBx9tajcS-6" value="" style="curved=1;endArrow=classic;html=1;rounded=0;" parent="1" source="8YBCCptctLdzBx9tajcS-1" target="8YBCCptctLdzBx9tajcS-3" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="90" y="220" as="sourcePoint" />
            <mxPoint x="140" y="170" as="targetPoint" />
            <Array as="points">
              <mxPoint x="200" y="120" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="8YBCCptctLdzBx9tajcS-7" value="&lt;div&gt;/ next_ch &amp;lt;= 0&lt;/div&gt;&lt;div&gt;sampling &amp;lt;= &#39;1&#39;&lt;/div&gt;&lt;div&gt;wr_addr_cnt &amp;lt;= (others =&amp;gt; &#39;0&#39;)&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;bf_shift_int &amp;lt;= (others =&amp;gt; &#39;0&#39;)&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;t_sample_rest &amp;lt;= &#39;0&#39;&lt;/div&gt;&lt;div&gt;t_period_rest &amp;lt;= &#39;0&#39;&lt;br&gt;&lt;/div&gt;&lt;div&gt;n_samples_out &amp;lt;= (others =&amp;gt; &#39;0&#39;)&lt;br&gt;&lt;/div&gt;&lt;div&gt;irq_out &amp;lt;= (others =&amp;gt; &#39;0&#39;)&lt;/div&gt;&lt;div&gt;period_done &amp;lt;= &#39;0&#39;&lt;br&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;rotation=-35;" parent="1" vertex="1">
          <mxGeometry x="90" y="25" width="190" height="130" as="geometry" />
        </mxCell>
        <mxCell id="8YBCCptctLdzBx9tajcS-8" value="s_sample" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" parent="1" vertex="1">
          <mxGeometry x="410" y="480" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="8YBCCptctLdzBx9tajcS-9" value="&lt;div&gt;t_sample_en &amp;lt;= &#39;0&#39;&lt;/div&gt;&lt;div&gt;t_period_en &amp;lt;= &#39;0&#39;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="325" y="20" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="8YBCCptctLdzBx9tajcS-10" value="t_sample_en &amp;lt;= &#39;0&#39;&lt;div&gt;t_period_en &amp;lt;= &#39;0&#39;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="30" y="255" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="8YBCCptctLdzBx9tajcS-11" value="" style="curved=1;endArrow=classic;html=1;rounded=0;" parent="1" source="8YBCCptctLdzBx9tajcS-3" target="8YBCCptctLdzBx9tajcS-8" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="210" y="410" as="sourcePoint" />
            <mxPoint x="260" y="360" as="targetPoint" />
            <Array as="points">
              <mxPoint x="210" y="430" />
              <mxPoint x="350" y="450" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="8YBCCptctLdzBx9tajcS-13" value="&lt;div&gt;if (rising_edge(adc_irq) and adc_ch = next_ch) /&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;rotation=30;" parent="1" vertex="1">
          <mxGeometry x="40" y="390" width="270" height="20" as="geometry" />
        </mxCell>
        <mxCell id="8YBCCptctLdzBx9tajcS-14" value="&lt;div&gt;s_sample&lt;/div&gt;&lt;div&gt;_wait&lt;/div&gt;" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" parent="1" vertex="1">
          <mxGeometry x="70" y="580" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="8YBCCptctLdzBx9tajcS-15" value="" style="curved=1;endArrow=classic;html=1;rounded=0;" parent="1" source="8YBCCptctLdzBx9tajcS-8" target="8YBCCptctLdzBx9tajcS-14" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="260" y="600" as="sourcePoint" />
            <mxPoint x="310" y="550" as="targetPoint" />
            <Array as="points">
              <mxPoint x="250" y="500" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="8YBCCptctLdzBx9tajcS-17" value="&lt;div&gt;/ next_ch &amp;lt;= &lt;i&gt;next channel&lt;/i&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;t_sample_rest &amp;lt;= &#39;0&#39;&lt;br&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;rotation=-20;" parent="1" vertex="1">
          <mxGeometry x="175" y="500" width="150" height="30" as="geometry" />
        </mxCell>
        <mxCell id="8YBCCptctLdzBx9tajcS-18" value="&lt;div&gt;s_sample&lt;/div&gt;&lt;div&gt;_finish&lt;/div&gt;" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" parent="1" vertex="1">
          <mxGeometry x="575" y="660" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="8YBCCptctLdzBx9tajcS-20" value="" style="curved=1;endArrow=classic;html=1;rounded=0;" parent="1" source="8YBCCptctLdzBx9tajcS-8" target="8YBCCptctLdzBx9tajcS-18" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="260" y="600" as="sourcePoint" />
            <mxPoint x="310" y="550" as="targetPoint" />
            <Array as="points">
              <mxPoint x="600" y="580" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="8YBCCptctLdzBx9tajcS-21" value="1" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="480" y="540" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="8YBCCptctLdzBx9tajcS-22" value="&lt;div&gt;if (next_ch = 11) /&lt;/div&gt;&lt;div&gt;sampling &amp;lt;= &#39;0&#39;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="550" y="545" width="110" height="30" as="geometry" />
        </mxCell>
        <mxCell id="8YBCCptctLdzBx9tajcS-23" value="t_sample_en &amp;lt;= &#39;1&#39;&lt;div&gt;t_period_en &amp;lt;= &#39;1&#39;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="-50" y="605" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="8YBCCptctLdzBx9tajcS-25" value="" style="curved=1;endArrow=classic;html=1;rounded=0;" parent="1" source="8YBCCptctLdzBx9tajcS-14" target="8YBCCptctLdzBx9tajcS-8" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="250" y="660" as="sourcePoint" />
            <mxPoint x="300" y="610" as="targetPoint" />
            <Array as="points">
              <mxPoint x="290" y="620" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="8YBCCptctLdzBx9tajcS-26" value="&lt;div&gt;if (rising_edge(adc_irq) and adc_ch = next_ch) /&lt;/div&gt;&lt;div&gt;if (next_ch = 0) then&lt;/div&gt;&lt;div&gt;t_sample_rest &amp;lt;= &#39;1&#39;&lt;/div&gt;&lt;div&gt;end if;&lt;br&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;rotation=-20;" parent="1" vertex="1">
          <mxGeometry x="180" y="600" width="270" height="60" as="geometry" />
        </mxCell>
        <mxCell id="8YBCCptctLdzBx9tajcS-27" value="t_sample_en &amp;lt;= &#39;1&#39;&lt;div&gt;t_period_en &amp;lt;= &#39;1&#39;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="390" y="450" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="8YBCCptctLdzBx9tajcS-28" value="" style="curved=1;endArrow=classic;html=1;rounded=0;" parent="1" source="8YBCCptctLdzBx9tajcS-18" target="8YBCCptctLdzBx9tajcS-14" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="270" y="750" as="sourcePoint" />
            <mxPoint x="320" y="700" as="targetPoint" />
            <Array as="points">
              <mxPoint x="290" y="750" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="8YBCCptctLdzBx9tajcS-29" value="&lt;div&gt;if (sample_start = &#39;1&#39;) /&lt;/div&gt;&lt;div&gt;next_ch &amp;lt;= 0&lt;/div&gt;&lt;div&gt;sampling &amp;lt;= &#39;1&#39;&lt;br&gt;&lt;/div&gt;wr_addr_cnt &amp;lt;= wr_addr_cnt + 1" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="280" y="730" width="190" height="60" as="geometry" />
        </mxCell>
        <mxCell id="8YBCCptctLdzBx9tajcS-30" value="t_sample_en &amp;lt;= &#39;1&#39;&lt;div&gt;t_period_en &amp;lt;= &#39;1&#39;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="555" y="740" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="8YBCCptctLdzBx9tajcS-31" value="2" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="550" y="690" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="8YBCCptctLdzBx9tajcS-32" value="s_shift" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" parent="1" vertex="1">
          <mxGeometry x="900" y="325" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="8YBCCptctLdzBx9tajcS-33" value="" style="curved=1;endArrow=classic;html=1;rounded=0;" parent="1" source="yGk2pAN8WluMj7sl2VAn-2" target="8YBCCptctLdzBx9tajcS-32" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1000" y="380" as="sourcePoint" />
            <mxPoint x="320" y="700" as="targetPoint" />
            <Array as="points">
              <mxPoint x="840" y="430" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="8YBCCptctLdzBx9tajcS-34" value="/ n_samples_out &amp;lt;= wr_addr_cnt+1&lt;br&gt;bf_shift_int &amp;lt;= (others =&amp;gt; &#39;0&#39;)" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;rotation=-30;" parent="1" vertex="1">
          <mxGeometry x="700" y="430" width="200" height="30" as="geometry" />
        </mxCell>
        <mxCell id="8YBCCptctLdzBx9tajcS-35" value="" style="curved=1;endArrow=classic;html=1;rounded=0;" parent="1" source="8YBCCptctLdzBx9tajcS-32" target="8YBCCptctLdzBx9tajcS-40" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="410" y="540" as="sourcePoint" />
            <mxPoint x="900" y="370" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1000" y="240" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="8YBCCptctLdzBx9tajcS-36" value="1" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="655" y="685" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="8YBCCptctLdzBx9tajcS-40" value="s_irq" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" parent="1" vertex="1">
          <mxGeometry x="875" y="125" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="8YBCCptctLdzBx9tajcS-41" value="&lt;div&gt;if (shifted_hold = accept_mask) / &lt;br&gt;&lt;/div&gt;&lt;div&gt;t_sample_rest &amp;lt;= &#39;1&#39;&lt;/div&gt;&lt;div&gt;t_period_rest &amp;lt;= &#39;1&#39;&lt;/div&gt;&lt;div&gt;irq_out &amp;lt;= accept_mask&lt;br&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;rotation=20;" parent="1" vertex="1">
          <mxGeometry x="2190" y="-40" width="190" height="60" as="geometry" />
        </mxCell>
        <mxCell id="8YBCCptctLdzBx9tajcS-44" value="&amp;nbsp;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="2310" y="130" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="8YBCCptctLdzBx9tajcS-45" value="2" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="390" y="500" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="8YBCCptctLdzBx9tajcS-46" value="" style="curved=1;endArrow=classic;html=1;rounded=0;" parent="1" source="8YBCCptctLdzBx9tajcS-40" target="yGk2pAN8WluMj7sl2VAn-23" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="330" y="360" as="sourcePoint" />
            <mxPoint x="790" y="200" as="targetPoint" />
            <Array as="points">
              <mxPoint x="810" y="70" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="8YBCCptctLdzBx9tajcS-47" value="&lt;div&gt;if (gain_settled = &#39;1&#39;) / &lt;br&gt;&lt;/div&gt;&lt;div&gt;next_ch &amp;lt;= 0&lt;/div&gt;&lt;div&gt;sampling &amp;lt;= &#39;1&#39;&lt;/div&gt;&lt;div&gt;wr_addr_cnt &amp;lt;= (others =&amp;gt; &#39;0&#39;)&lt;/div&gt;&lt;div&gt;n_samples_out &amp;lt;= (others =&amp;gt; &#39;0&#39;)&lt;br&gt;&lt;/div&gt;&lt;div&gt;period_done &amp;lt;= &#39;0&#39;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;rotation=-5;" parent="1" vertex="1">
          <mxGeometry x="570" y="160" width="190" height="90" as="geometry" />
        </mxCell>
        <mxCell id="8YBCCptctLdzBx9tajcS-48" value="t_sample_en &amp;lt;= &#39;1&#39;&lt;div&gt;t_period_en &amp;lt;= &#39;0&#39;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="860" y="90" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="8YBCCptctLdzBx9tajcS-49" value="t_sample_en &amp;lt;= &#39;1&#39;&lt;div&gt;t_period_en &amp;lt;= &#39;0&#39;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="890" y="540" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="yGk2pAN8WluMj7sl2VAn-2" value="&lt;div&gt;s_period&lt;/div&gt;&lt;div&gt;_done&lt;br&gt;&lt;/div&gt;" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" parent="1" vertex="1">
          <mxGeometry x="810" y="510" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="yGk2pAN8WluMj7sl2VAn-3" value="" style="curved=1;endArrow=classic;html=1;rounded=0;" parent="1" source="8YBCCptctLdzBx9tajcS-18" target="yGk2pAN8WluMj7sl2VAn-2" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="810" y="700" as="sourcePoint" />
            <mxPoint x="860" y="650" as="targetPoint" />
            <Array as="points">
              <mxPoint x="810" y="710" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="yGk2pAN8WluMj7sl2VAn-4" value="&lt;div&gt;if (sample_stop = &#39;1&#39;) /&lt;/div&gt;&lt;div&gt;period_done &amp;lt;= &#39;1&#39;&lt;/div&gt;&lt;div&gt;bf_shift_int &amp;lt;= FFF&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;rotation=-35;" parent="1" vertex="1">
          <mxGeometry x="735" y="665" width="130" height="50" as="geometry" />
        </mxCell>
        <mxCell id="yGk2pAN8WluMj7sl2VAn-5" value="t_sample_en &amp;lt;= &#39;1&#39;&lt;div&gt;t_period_en &amp;lt;= &#39;0&#39;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="980" y="350" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="yGk2pAN8WluMj7sl2VAn-6" value="&lt;div&gt;s_gain&lt;/div&gt;&lt;div&gt;_eval&lt;br&gt;&lt;/div&gt;" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" parent="1" vertex="1">
          <mxGeometry x="2290" y="270" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="yGk2pAN8WluMj7sl2VAn-7" value="&lt;div&gt;s_gain&lt;/div&gt;&lt;div&gt;_fetch&lt;br&gt;&lt;/div&gt;" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" parent="1" vertex="1">
          <mxGeometry x="2650" y="305" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="yGk2pAN8WluMj7sl2VAn-8" value="" style="curved=1;endArrow=classic;html=1;rounded=0;" parent="1" source="yGk2pAN8WluMj7sl2VAn-6" target="yGk2pAN8WluMj7sl2VAn-7" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="2520" y="380" as="sourcePoint" />
            <mxPoint x="2570" y="330" as="targetPoint" />
            <Array as="points">
              <mxPoint x="2510" y="390" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="yGk2pAN8WluMj7sl2VAn-9" value="&lt;div&gt;if (accept_mask(mag_cnt*3+2 downto mag_cnt*3) != &quot;111&quot;) /&lt;/div&gt;&lt;div&gt;lut_n_over &amp;lt;= n_over_mags(mag_cnt)&lt;/div&gt;&lt;div&gt;lut_top_val &amp;lt;= top_mags(mag_cnt)&lt;/div&gt;&lt;div&gt;lut_curr_gain &amp;lt;= gain_curr_int(mag_cnt)&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;rotation=16.999999999999996;" parent="1" vertex="1">
          <mxGeometry x="2380" y="390" width="340" height="60" as="geometry" />
        </mxCell>
        <mxCell id="yGk2pAN8WluMj7sl2VAn-10" value="&lt;div&gt;s_gain&lt;/div&gt;&lt;div&gt;_done&lt;/div&gt;" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" parent="1" vertex="1">
          <mxGeometry x="2370" y="100" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="yGk2pAN8WluMj7sl2VAn-11" value="" style="curved=1;endArrow=classic;html=1;rounded=0;" parent="1" source="SsunDbkqlPeY4llJMre3-5" target="yGk2pAN8WluMj7sl2VAn-10" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="2490" y="180" as="sourcePoint" />
            <mxPoint x="2530" y="60" as="targetPoint" />
            <Array as="points">
              <mxPoint x="2540" y="170" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="yGk2pAN8WluMj7sl2VAn-16" value="&lt;div&gt;if (rising_edge(lut_irq)) /&lt;/div&gt;&lt;div&gt;gain_ref_int(mag_cnt) &amp;lt;= lut_new_gain&lt;br&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;rotation=-18;" parent="1" vertex="1">
          <mxGeometry x="2440" y="150" width="220" height="30" as="geometry" />
        </mxCell>
        <mxCell id="yGk2pAN8WluMj7sl2VAn-17" value="" style="curved=1;endArrow=classic;html=1;rounded=0;" parent="1" source="yGk2pAN8WluMj7sl2VAn-10" target="yGk2pAN8WluMj7sl2VAn-6" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="2270" y="210" as="sourcePoint" />
            <mxPoint x="2320" y="160" as="targetPoint" />
            <Array as="points">
              <mxPoint x="2300" y="170" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="yGk2pAN8WluMj7sl2VAn-18" value="&lt;div&gt;if (mag_cnt &amp;lt; 3) /&lt;/div&gt;&lt;div&gt;mag_cnt &amp;lt;= mag_cnt + 1&lt;br&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;rotation=-56;" parent="1" vertex="1">
          <mxGeometry x="2230" y="163" width="150" height="30" as="geometry" />
        </mxCell>
        <mxCell id="yGk2pAN8WluMj7sl2VAn-20" value="" style="curved=1;endArrow=classic;html=1;rounded=0;" parent="1" source="yGk2pAN8WluMj7sl2VAn-6" target="yGk2pAN8WluMj7sl2VAn-10" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="2390" y="260" as="sourcePoint" />
            <mxPoint x="2440" y="210" as="targetPoint" />
            <Array as="points">
              <mxPoint x="2430" y="250" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="yGk2pAN8WluMj7sl2VAn-21" value="1" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="2360" y="330" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="yGk2pAN8WluMj7sl2VAn-22" value="2" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="2370" y="280" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="yGk2pAN8WluMj7sl2VAn-23" value="&lt;div&gt;s_gain&lt;/div&gt;&lt;div&gt;_wait&lt;/div&gt;" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" parent="1" vertex="1">
          <mxGeometry x="625" y="45" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="yGk2pAN8WluMj7sl2VAn-24" value="/ t_period_rest &amp;lt;= &#39;0&#39;&lt;br&gt;&lt;div&gt;irq_out &amp;lt;= (others =&amp;gt; &#39;0&#39;)&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;rotation=-30;" parent="1" vertex="1">
          <mxGeometry x="760" y="20" width="150" height="30" as="geometry" />
        </mxCell>
        <mxCell id="yGk2pAN8WluMj7sl2VAn-25" value="" style="curved=1;endArrow=classic;html=1;rounded=0;" parent="1" source="yGk2pAN8WluMj7sl2VAn-23" target="-SvlVW-lZLVL1e7jGKam-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="260" y="260" as="sourcePoint" />
            <mxPoint x="510" y="370" as="targetPoint" />
            <Array as="points">
              <mxPoint x="600" y="170" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="yGk2pAN8WluMj7sl2VAn-27" value="1" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="2350" y="140" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="yGk2pAN8WluMj7sl2VAn-29" value="2" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="2370" y="90" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="yGk2pAN8WluMj7sl2VAn-30" value="t_sample_en &amp;lt;= &#39;0&#39;&lt;div&gt;t_period_en &amp;lt;= &#39;0&#39;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="2245" y="350" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="yGk2pAN8WluMj7sl2VAn-31" value="t_sample_en &amp;lt;= &#39;0&#39;&lt;div&gt;t_period_en &amp;lt;= &#39;0&#39;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="2560" y="280" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="yGk2pAN8WluMj7sl2VAn-32" value="t_sample_en &amp;lt;= &#39;0&#39;&lt;div&gt;t_period_en &amp;lt;= &#39;0&#39;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="2380" y="65" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="yGk2pAN8WluMj7sl2VAn-33" value="t_sample_en &amp;lt;= &#39;1&#39;&lt;div&gt;t_period_en &amp;lt;= &#39;0&#39;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="605" y="15" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Pzn7crQTOOGF5psaZsjJ-1" value="&amp;nbsp;" style="text;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="780" y="260" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Pzn7crQTOOGF5psaZsjJ-2" value="&amp;nbsp;" style="text;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="760" y="480" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Pzn7crQTOOGF5psaZsjJ-4" value="&lt;div&gt;s_rst&lt;/div&gt;" style="ellipse;shape=doubleEllipse;whiteSpace=wrap;html=1;aspect=fixed;" parent="1" vertex="1">
          <mxGeometry x="430" y="910" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="Pzn7crQTOOGF5psaZsjJ-5" value="&lt;div&gt;s_wait&lt;/div&gt;&lt;div&gt;_sample&lt;/div&gt;" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" parent="1" vertex="1">
          <mxGeometry x="445" y="1140" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="Pzn7crQTOOGF5psaZsjJ-6" value="&lt;div&gt;s_get&lt;/div&gt;&lt;div&gt;_sample&lt;br&gt;&lt;/div&gt;" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" parent="1" vertex="1">
          <mxGeometry x="555" y="1320" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="Pzn7crQTOOGF5psaZsjJ-7" value="&lt;div&gt;s_start_mon&lt;/div&gt;" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" parent="1" vertex="1">
          <mxGeometry x="145" y="1230" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="Pzn7crQTOOGF5psaZsjJ-8" value="s_finished" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" parent="1" vertex="1">
          <mxGeometry x="130" y="970" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="Pzn7crQTOOGF5psaZsjJ-9" value="" style="curved=1;endArrow=classic;html=1;rounded=0;" parent="1" source="Pzn7crQTOOGF5psaZsjJ-4" target="Pzn7crQTOOGF5psaZsjJ-5" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="550" y="1110" as="sourcePoint" />
            <mxPoint x="600" y="1060" as="targetPoint" />
            <Array as="points">
              <mxPoint x="520" y="1060" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="Pzn7crQTOOGF5psaZsjJ-10" value="&lt;div&gt;/ accept_mask &amp;lt;= (others =&amp;gt; &#39;0&#39;)&lt;/div&gt;&lt;div&gt;gain_UnD &amp;lt;= (others =&amp;gt; &#39;0&#39;)&lt;/div&gt;&lt;div&gt;top_values &amp;lt;= 0&lt;/div&gt;&lt;div&gt;n_over &amp;lt;= 0&lt;/div&gt;&lt;div&gt;top_mags &amp;lt;= 0&lt;/div&gt;&lt;div&gt;n_over_mags &amp;lt;= 0&lt;/div&gt;&lt;div&gt;gain_mon_rdy &amp;lt;= 0&lt;br&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="493" y="1010" width="190" height="100" as="geometry" />
        </mxCell>
        <mxCell id="Pzn7crQTOOGF5psaZsjJ-11" value="" style="curved=1;endArrow=classic;html=1;rounded=0;" parent="1" source="Pzn7crQTOOGF5psaZsjJ-5" target="Pzn7crQTOOGF5psaZsjJ-6" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="550" y="1240" as="sourcePoint" />
            <mxPoint x="600" y="1190" as="targetPoint" />
            <Array as="points">
              <mxPoint x="570" y="1250" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="Pzn7crQTOOGF5psaZsjJ-12" value="&lt;div&gt;adc_irq = 1 /&lt;/div&gt;&lt;div&gt;latch_adc_din &amp;lt;= adc_din&lt;/div&gt;&lt;div&gt;latch_adc_ch &amp;lt;= adc_ch&lt;br&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="555" y="1210" width="150" height="50" as="geometry" />
        </mxCell>
        <mxCell id="Pzn7crQTOOGF5psaZsjJ-13" value="2" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="520" y="1200" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="Pzn7crQTOOGF5psaZsjJ-14" value="" style="curved=1;endArrow=classic;html=1;rounded=0;" parent="1" source="Pzn7crQTOOGF5psaZsjJ-6" target="Pzn7crQTOOGF5psaZsjJ-5" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="460" y="1370" as="sourcePoint" />
            <mxPoint x="510" y="1320" as="targetPoint" />
            <Array as="points">
              <mxPoint x="500" y="1300" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="Pzn7crQTOOGF5psaZsjJ-15" value="&lt;div&gt;adc_irq = 0 /&lt;/div&gt;&lt;div&gt;if (latch_adc_din &amp;gt; GAIN_HYST_MAX)&lt;/div&gt;&lt;div&gt;n_over(latch_adc_ch) &amp;lt;= +1&lt;/div&gt;&lt;div&gt;end if&lt;/div&gt;&lt;div&gt;if (latch_adc_din &amp;gt; top_values(latch_adc_ch)) &lt;br&gt;&lt;/div&gt;&lt;div&gt;top_values(latch_adc_cd) &amp;gt;= latch_adc_din&lt;/div&gt;&lt;div&gt;end if&lt;br&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;rotation=-50;" parent="1" vertex="1">
          <mxGeometry x="295" y="1340" width="260" height="100" as="geometry" />
        </mxCell>
        <mxCell id="Pzn7crQTOOGF5psaZsjJ-16" value="" style="curved=1;endArrow=classic;html=1;rounded=0;" parent="1" source="Pzn7crQTOOGF5psaZsjJ-5" target="Pzn7crQTOOGF5psaZsjJ-7" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="550" y="1240" as="sourcePoint" />
            <mxPoint x="600" y="1190" as="targetPoint" />
            <Array as="points">
              <mxPoint x="300" y="1170" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="Pzn7crQTOOGF5psaZsjJ-17" value="1" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="420" y="1180" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="Pzn7crQTOOGF5psaZsjJ-18" value="&lt;div&gt;period_done = 1 /&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;rotation=-20;" parent="1" vertex="1">
          <mxGeometry x="240" y="1160" width="110" height="20" as="geometry" />
        </mxCell>
        <mxCell id="Pzn7crQTOOGF5psaZsjJ-20" value="/ gain_mon_rdy &amp;lt;= 1" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="-70" y="1000" width="130" height="20" as="geometry" />
        </mxCell>
        <mxCell id="Pzn7crQTOOGF5psaZsjJ-21" value="" style="curved=1;endArrow=classic;html=1;rounded=0;" parent="1" source="Pzn7crQTOOGF5psaZsjJ-8" target="Pzn7crQTOOGF5psaZsjJ-4" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="280" y="1020" as="sourcePoint" />
            <mxPoint x="330" y="970" as="targetPoint" />
            <Array as="points">
              <mxPoint x="310" y="910" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="Pzn7crQTOOGF5psaZsjJ-22" value="period_done = 0 /" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="235" y="910" width="110" height="20" as="geometry" />
        </mxCell>
        <mxCell id="Pzn7crQTOOGF5psaZsjJ-23" value="s_mon_ch" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" parent="1" vertex="1">
          <mxGeometry y="1400" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="Pzn7crQTOOGF5psaZsjJ-24" value="" style="curved=1;endArrow=classic;html=1;rounded=0;" parent="1" source="Pzn7crQTOOGF5psaZsjJ-7" target="Pzn7crQTOOGF5psaZsjJ-23" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-10" y="1390" as="sourcePoint" />
            <mxPoint x="40" y="1340" as="targetPoint" />
            <Array as="points">
              <mxPoint x="150" y="1380" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="Pzn7crQTOOGF5psaZsjJ-25" value="&lt;div&gt;/&lt;br&gt;&lt;/div&gt;&lt;div&gt;if (n_over(mon_mag*3+mon_axis) &amp;gt; n_over_mag(mon_mag)) then&lt;/div&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; n_over_mag(mon_mag)&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;=&amp;nbsp; n_over(mon_mag*3+mon_axis);&lt;br&gt;end if;&lt;br&gt;if (top_values(mon_mag*3+mon_axis) &amp;gt; top_mag(mon_mag)) then&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; top_mag(mon_mag)&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;=&amp;nbsp; top_values(mon_mag*3+mon_axis);&lt;br&gt;end if;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;rotation=30;" parent="1" vertex="1">
          <mxGeometry x="-125" y="1570" width="380" height="100" as="geometry" />
        </mxCell>
        <mxCell id="Pzn7crQTOOGF5psaZsjJ-26" value="s_mon_next" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" parent="1" vertex="1">
          <mxGeometry x="-240" y="1440" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="Pzn7crQTOOGF5psaZsjJ-27" value="" style="curved=1;endArrow=classic;html=1;rounded=0;" parent="1" source="Pzn7crQTOOGF5psaZsjJ-23" target="Pzn7crQTOOGF5psaZsjJ-26" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-90" y="1550" as="sourcePoint" />
            <mxPoint x="-40" y="1500" as="targetPoint" />
            <Array as="points">
              <mxPoint x="-60" y="1520" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="Pzn7crQTOOGF5psaZsjJ-29" value="" style="curved=1;endArrow=classic;html=1;rounded=0;" parent="1" source="Pzn7crQTOOGF5psaZsjJ-26" target="Pzn7crQTOOGF5psaZsjJ-23" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-150" y="1420" as="sourcePoint" />
            <mxPoint x="-100" y="1370" as="targetPoint" />
            <Array as="points">
              <mxPoint x="-100" y="1410" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="Pzn7crQTOOGF5psaZsjJ-30" value="s_next_mag" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" parent="1" vertex="1">
          <mxGeometry x="-130" y="1250" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="Pzn7crQTOOGF5psaZsjJ-31" value="" style="curved=1;endArrow=classic;html=1;rounded=0;" parent="1" source="Pzn7crQTOOGF5psaZsjJ-26" target="Pzn7crQTOOGF5psaZsjJ-30" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-150" y="1420" as="sourcePoint" />
            <mxPoint x="-100" y="1370" as="targetPoint" />
            <Array as="points">
              <mxPoint x="-210" y="1340" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="Pzn7crQTOOGF5psaZsjJ-32" value="&lt;div style=&quot;font-size: 8px&quot;&gt;&lt;font style=&quot;font-size: 8px&quot;&gt;mon_axis = &quot;10&quot; /&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 8px&quot;&gt;&lt;font style=&quot;font-size: 8px&quot;&gt;if (n_over_mag(mon_mag) &amp;gt; &quot;0&quot;) then&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; accept_mask(mon_mag*3+2 downto mon_mag*3)&amp;nbsp;&amp;nbsp; &amp;lt;=&amp;nbsp; &quot;000&quot;;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; gain_UnD(mon_mag)&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;=&amp;nbsp; &#39;1&#39;;&lt;br&gt;elsif (UNSIGNED(top_mag(i)) &amp;lt; UNSIGNED(GAIN_HYST_MIN_THRESH)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 8px&quot;&gt;&lt;font style=&quot;font-size: 8px&quot;&gt;and gain_curr(mon_mag*6+5 downto mon_mag*6) /= &quot;111111&quot;) then&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; accept_mask(mon_mag*3+2 downto mon_mag*3)&amp;nbsp;&amp;nbsp; &amp;lt;=&amp;nbsp; &quot;000&quot;;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; gain_UnD(mon_mag)&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;=&amp;nbsp; &#39;0&#39;;&lt;br&gt;else&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; accept_mask(mon_mag*3+2 downto mon_mag*3)&amp;nbsp;&amp;nbsp; &amp;lt;=&amp;nbsp; &quot;111&quot;;&lt;br&gt;end if;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;rotation=-60;" parent="1" vertex="1">
          <mxGeometry x="-360" y="1230" width="280" height="160" as="geometry" />
        </mxCell>
        <mxCell id="Pzn7crQTOOGF5psaZsjJ-34" value="&lt;div&gt;s_mon&lt;/div&gt;&lt;div&gt;_finish&lt;br&gt;&lt;/div&gt;" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" parent="1" vertex="1">
          <mxGeometry x="-120" y="1070" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="Pzn7crQTOOGF5psaZsjJ-35" value="" style="curved=1;endArrow=classic;html=1;rounded=0;" parent="1" source="Pzn7crQTOOGF5psaZsjJ-30" target="Pzn7crQTOOGF5psaZsjJ-34" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-340" y="1290" as="sourcePoint" />
            <mxPoint x="-290" y="1240" as="targetPoint" />
            <Array as="points">
              <mxPoint x="-30" y="1180" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="Pzn7crQTOOGF5psaZsjJ-37" value="" style="curved=1;endArrow=classic;html=1;rounded=0;" parent="1" source="Pzn7crQTOOGF5psaZsjJ-30" target="Pzn7crQTOOGF5psaZsjJ-23" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="30" y="1360" as="sourcePoint" />
            <mxPoint x="80" y="1310" as="targetPoint" />
            <Array as="points">
              <mxPoint x="30" y="1330" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="Pzn7crQTOOGF5psaZsjJ-38" value="/ mon_mag &amp;lt;= 0&lt;div&gt;mon_axis &amp;lt;= 0&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;rotation=-15;" parent="1" vertex="1">
          <mxGeometry x="125" y="1375" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Pzn7crQTOOGF5psaZsjJ-39" value="/ mon_axis &amp;lt;= +1" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;rotation=-15;" parent="1" vertex="1">
          <mxGeometry x="-150" y="1405" width="110" height="20" as="geometry" />
        </mxCell>
        <mxCell id="Pzn7crQTOOGF5psaZsjJ-40" value="1" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="-200" y="1420" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="Pzn7crQTOOGF5psaZsjJ-41" value="2" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="-160" y="1450" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="Pzn7crQTOOGF5psaZsjJ-43" value="&lt;div&gt;mon_mag = &quot;11&quot; /&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="-50" y="1210" width="110" height="20" as="geometry" />
        </mxCell>
        <mxCell id="Pzn7crQTOOGF5psaZsjJ-44" value="&lt;div&gt;/ mon_axis &amp;lt;= &quot;00&quot;&lt;br&gt;&lt;/div&gt;&lt;div&gt;mon_ch &amp;lt;= mon_ch + &quot;1&quot;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;rotation=45;" parent="1" vertex="1">
          <mxGeometry x="-50" y="1305" width="150" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Pzn7crQTOOGF5psaZsjJ-45" value="" style="curved=1;endArrow=classic;html=1;rounded=0;fontSize=8;" parent="1" source="Pzn7crQTOOGF5psaZsjJ-34" target="Pzn7crQTOOGF5psaZsjJ-8" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-70" y="1030" as="sourcePoint" />
            <mxPoint x="-20" y="980" as="targetPoint" />
            <Array as="points">
              <mxPoint x="40" y="1000" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="Pzn7crQTOOGF5psaZsjJ-46" value="1" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="-70" y="1240" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="Pzn7crQTOOGF5psaZsjJ-47" value="2" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="-50" y="1280" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="SsunDbkqlPeY4llJMre3-1" value="&amp;nbsp;" style="text;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="640" y="-60" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="SsunDbkqlPeY4llJMre3-2" value="&lt;div&gt;s_gain&lt;/div&gt;&lt;div&gt;_fetch_start&lt;/div&gt;" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" parent="1" vertex="1">
          <mxGeometry x="2800" y="135" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="SsunDbkqlPeY4llJMre3-3" value="" style="curved=1;endArrow=classic;html=1;rounded=0;" parent="1" source="yGk2pAN8WluMj7sl2VAn-7" target="SsunDbkqlPeY4llJMre3-2" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="2600" y="130" as="sourcePoint" />
            <mxPoint x="2650" y="80" as="targetPoint" />
            <Array as="points">
              <mxPoint x="2800" y="260" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="SsunDbkqlPeY4llJMre3-4" value="&lt;div&gt;if (lut_idle = &#39;1&#39;) /&lt;/div&gt;&lt;div&gt;lut_start &amp;lt;= &#39;1&#39;&lt;br&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="2790" y="250" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="SsunDbkqlPeY4llJMre3-5" value="&lt;div&gt;s_gain&lt;/div&gt;&lt;div&gt;_fetch_start&lt;/div&gt;" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" parent="1" vertex="1">
          <mxGeometry x="2590" y="35" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="SsunDbkqlPeY4llJMre3-6" value="" style="curved=1;endArrow=classic;html=1;rounded=0;" parent="1" source="SsunDbkqlPeY4llJMre3-2" target="SsunDbkqlPeY4llJMre3-5" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="2680" y="130" as="sourcePoint" />
            <mxPoint x="2730" y="80" as="targetPoint" />
            <Array as="points">
              <mxPoint x="2780" y="30" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="SsunDbkqlPeY4llJMre3-7" value="&lt;div&gt;lut_idle = &#39;0&#39; / &lt;br&gt;&lt;/div&gt;&lt;div&gt;lut_start &amp;lt;= &#39;0&#39;&lt;br&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="2750" y="30" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="SsunDbkqlPeY4llJMre3-8" value="t_sample_en &amp;lt;= &#39;0&#39;&lt;div&gt;t_period_en &amp;lt;= &#39;0&#39;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="2570" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="SsunDbkqlPeY4llJMre3-9" value="t_sample_en &amp;lt;= &#39;0&#39;&lt;div&gt;t_period_en &amp;lt;= &#39;0&#39;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="2880" y="160" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="SsunDbkqlPeY4llJMre3-10" value="&lt;div&gt;/ bf_shift &amp;lt;= (others =&amp;gt; &#39;0&#39;)&lt;/div&gt;&lt;div&gt;mag_cnt &amp;lt;= 0&lt;/div&gt;&lt;div&gt;bf_shift_int &amp;lt;= (others =&amp;gt; &#39;0&#39;)&lt;br&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="2080" y="280" width="170" height="50" as="geometry" />
        </mxCell>
        <mxCell id="SsunDbkqlPeY4llJMre3-11" value="&lt;div&gt;if (shifted_hold = FFF) / &lt;br&gt;&lt;/div&gt;&lt;div&gt;t_period_rest &amp;lt;= &#39;1&#39;&lt;/div&gt;&lt;div&gt;irq_out &amp;lt;= FFF&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;rotation=20;" parent="1" vertex="1">
          <mxGeometry x="960" y="225" width="140" height="50" as="geometry" />
        </mxCell>
        <mxCell id="SsunDbkqlPeY4llJMre3-12" value="&lt;div&gt;if (gain_mon_rdy = &#39;1&#39;) /&lt;/div&gt;&lt;div&gt;n_samples_out &amp;lt;= wr_addr_cnt+1&lt;br&gt;&lt;/div&gt;&lt;div&gt;bf_shift_int &amp;lt;= accept_mask&lt;br&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;rotation=-30;" parent="1" vertex="1">
          <mxGeometry x="1360" y="380" width="200" height="50" as="geometry" />
        </mxCell>
        <mxCell id="-SvlVW-lZLVL1e7jGKam-1" value="&lt;div&gt;s_sample&lt;/div&gt;&lt;div&gt;_continue&lt;/div&gt;" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" vertex="1" parent="1">
          <mxGeometry x="445" y="220" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="-SvlVW-lZLVL1e7jGKam-2" value="" style="curved=1;endArrow=classic;html=1;rounded=0;" edge="1" parent="1" source="-SvlVW-lZLVL1e7jGKam-1" target="8YBCCptctLdzBx9tajcS-8">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="210" y="410" as="sourcePoint" />
            <mxPoint x="260" y="360" as="targetPoint" />
            <Array as="points">
              <mxPoint x="360" y="360" />
              <mxPoint x="580" y="450" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="-SvlVW-lZLVL1e7jGKam-3" value="t_sample_en &amp;lt;= &#39;1&#39;&lt;div&gt;t_period_en &amp;lt;= &#39;0&#39;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="430" y="190" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-SvlVW-lZLVL1e7jGKam-5" value="&lt;div&gt;if (rising_edge(adc_irq) and adc_ch = next_ch) /&lt;/div&gt;&lt;div&gt;t_sample_rest &amp;lt;= &#39;1&#39;&lt;br&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;rotation=30;" vertex="1" parent="1">
          <mxGeometry x="410" y="415" width="270" height="30" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
